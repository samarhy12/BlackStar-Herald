<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      {% block title %}Admin Dashboard{% endblock %} - BlackStar Herald
    </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
          font-family: 'Inter', sans-serif;
      }
      .sidebar {
          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      @media (max-width: 1024px) {
          .sidebar.hidden-mobile {
              transform: translateX(-100%);
          }
      }
      .sidebar-link {
          position: relative;
          overflow: hidden;
      }
      .sidebar-link::before {
          content: '';
          position: absolute;
          left: 0;
          top: 0;
          bottom: 0;
          width: 4px;
          background: linear-gradient(180deg, #3b82f6, #1d4ed8);
          transform: scaleY(0);
          transition: transform 0.3s ease;
      }
      .sidebar-link:hover::before,
      .sidebar-link.active::before {
          transform: scaleY(1);
      }
      .mobile-overlay {
          display: none;
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 25;
          opacity: 0;
          transition: opacity 0.3s ease;
      }
      .mobile-overlay.active {
          display: block;
          opacity: 1;
      }
      {% block extra_css %}{% endblock %}
    </style>
  </head>
  <body class="bg-gray-50 antialiased">
    <!-- Mobile Overlay -->
    <div id="mobile-overlay" class="mobile-overlay"></div>

    <!-- Top Bar -->
    <div
      class="bg-white shadow-sm border-b border-gray-200 fixed top-0 left-0 right-0 z-40"
    >
      <div class="flex items-center justify-between px-4 md:px-6 py-3 md:py-4">
        <div class="flex items-center gap-3 md:gap-4">
          <button
            id="sidebar-toggle"
            class="text-gray-600 hover:text-gray-900 lg:hidden p-2 hover:bg-gray-100 rounded-lg transition"
          >
            <i class="fas fa-bars text-xl"></i>
          </button>
          <div class="flex items-center gap-2 md:gap-3">
            <div
              class="bg-gradient-to-br from-blue-600 to-indigo-600 text-white w-10 h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center font-bold shadow-lg"
            >
              ES
            </div>
            <div class="hidden sm:block">
              <h1 class="font-bold text-base md:text-lg text-gray-900">
                BlackStar Herald
              </h1>
              <p class="text-xs text-gray-500">Admin Panel</p>
            </div>
          </div>
        </div>

        <div class="flex items-center gap-2 md:gap-4">
          <!-- View Site -->
          <a
            href="/"
            target="_blank"
            class="hidden md:flex items-center gap-2 text-gray-600 hover:text-gray-900 px-3 py-2 hover:bg-gray-100 rounded-lg transition"
          >
            <i class="fas fa-external-link-alt"></i>
            <span>View Site</span>
          </a>

          <!-- User Menu -->
          <div class="relative group">
            <button
              class="flex items-center gap-2 md:gap-3 text-gray-700 hover:text-gray-900 hover:bg-gray-100 px-2 md:px-3 py-2 rounded-lg transition"
            >
              <img
                src="https://ui-avatars.com/api/?name={{ session.full_name }}&background=random&color=fff&bold=true"
                alt="{{ session.full_name }}"
                class="w-8 h-8 md:w-9 md:h-9 rounded-full ring-2 ring-gray-200"
              />
              <div class="hidden md:block text-left">
                <p class="font-semibold text-sm">{{ session.full_name }}</p>
                <p class="text-xs text-gray-500 capitalize">
                  {{ session.role }}
                </p>
              </div>
              <i
                class="fas fa-chevron-down text-xs text-gray-400 hidden md:block"
              ></i>
            </button>

            <!-- Dropdown Menu -->
            <div
              class="absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50"
            >
              <div class="px-4 py-3 border-b border-gray-100">
                <p class="text-sm font-semibold text-gray-900">
                  {{ session.full_name }}
                </p>
                <p class="text-xs text-gray-500 capitalize">
                  {{ session.role }}
                </p>
              </div>
              <a
                href="/"
                target="_blank"
                class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition md:hidden"
              >
                <i class="fas fa-external-link-alt w-4"></i>
                <span>View Site</span>
              </a>
              <a
                href="{{ url_for('admin_settings') }}"
                class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition"
              >
                <i class="fas fa-user-cog w-4"></i>
                <span>Account Settings</span>
              </a>
              <div class="border-t border-gray-100 mt-2 pt-2">
                <a
                  href="{{ url_for('admin_logout') }}"
                  class="flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition"
                >
                  <i class="fas fa-sign-out-alt w-4"></i>
                  <span>Logout</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="flex pt-14 md:pt-16">
      <!-- Sidebar -->
      <aside
        id="sidebar"
        class="sidebar bg-white w-64 md:w-72 fixed left-0 top-14 md:top-16 bottom-0 shadow-xl overflow-y-auto z-30 border-r border-gray-200 hidden-mobile"
      >
        <nav class="p-4 md:p-6">
          <!-- Main Navigation -->
          <div class="mb-6">
            <p
              class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-4"
            >
              Main Menu
            </p>
            <ul class="space-y-1">
              <li>
                <a
                  href="{{ url_for('admin_dashboard') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-xl transition group {% if request.endpoint == 'admin_dashboard' %}bg-blue-50 text-blue-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-blue-100 text-blue-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-tachometer-alt"></i>
                  </div>
                  <span class="font-medium">Dashboard</span>
                </a>
              </li>
              <li>
                <a
                  href="{{ url_for('admin_articles') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-green-50 hover:text-green-600 rounded-xl transition group {% if request.endpoint in ['admin_articles', 'admin_edit_article'] %}bg-green-50 text-green-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-green-100 text-green-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-newspaper"></i>
                  </div>
                  <span class="font-medium">Articles</span>
                </a>
              </li>
              <li>
                <a
                  href="{{ url_for('admin_new_article') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-purple-50 hover:text-purple-600 rounded-xl transition group {% if request.endpoint == 'admin_new_article' %}bg-purple-50 text-purple-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-purple-100 text-purple-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-plus-circle"></i>
                  </div>
                  <span class="font-medium">New Article</span>
                </a>
              </li>
            </ul>
          </div>

          <!-- Communication -->
          <div class="mb-6">
            <p
              class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-4"
            >
              Communication
            </p>
            <ul class="space-y-1">
              <li>
                <a
                  href="{{ url_for('admin_newsletter') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-orange-50 hover:text-orange-600 rounded-xl transition group {% if request.endpoint == 'admin_newsletter' %}bg-orange-50 text-orange-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-orange-100 text-orange-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-envelope"></i>
                  </div>
                  <span class="font-medium">Newsletter</span>
                </a>
              </li>
            </ul>
          </div>

          <!-- Admin Only -->
          {% if session.role == 'admin' %}
          <div class="mb-6">
            <p
              class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-4"
            >
              Administration
            </p>
            <ul class="space-y-1">
              <li>
                <a
                  href="{{ url_for('admin_categories') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-teal-50 hover:text-teal-600 rounded-xl transition group {% if request.endpoint == 'admin_categories' %}bg-teal-50 text-teal-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-teal-100 text-teal-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-folder-open"></i>
                  </div>
                  <span class="font-medium">Categories</span>
                </a>
              </li>
              <li>
                <a
                  href="{{ url_for('admin_users') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-pink-50 hover:text-pink-600 rounded-xl transition group {% if request.endpoint == 'admin_users' %}bg-pink-50 text-pink-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-pink-100 text-pink-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-users-cog"></i>
                  </div>
                  <span class="font-medium">Users</span>
                </a>
              </li>
              <li>
                <a
                  href="{{ url_for('admin_settings') }}"
                  class="sidebar-link flex items-center gap-3 px-4 py-3 text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 rounded-xl transition group {% if request.endpoint == 'admin_settings' %}bg-indigo-50 text-indigo-600 active{% endif %}"
                >
                  <div
                    class="w-10 h-10 rounded-lg bg-indigo-100 text-indigo-600 flex items-center justify-center group-hover:scale-110 transition"
                  >
                    <i class="fas fa-cog"></i>
                  </div>
                  <span class="font-medium">Settings</span>
                </a>
              </li>
            </ul>
          </div>
          {% endif %}

          <!-- Help Section -->
          <div class="mt-auto pt-6 border-t border-gray-200">
            <div
              class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-100"
            >
              <div class="flex items-center gap-3 mb-3">
                <div
                  class="w-10 h-10 rounded-lg bg-blue-600 text-white flex items-center justify-center"
                >
                  <i class="fas fa-question-circle"></i>
                </div>
                <div>
                  <p class="font-bold text-gray-900 text-sm">Need Help?</p>
                  <p class="text-xs text-gray-600">We're here for you</p>
                </div>
              </div>
              <a
                href="#"
                class="block text-center bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium px-4 py-2 rounded-lg transition"
              >
                Documentation
              </a>
            </div>
          </div>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 lg:ml-72 p-4 md:p-6 lg:p-8 min-h-screen">
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %}
        <div class="mb-6 space-y-3">
          {% for category, message in messages %}
          <div
            class="p-4 rounded-xl shadow-lg {% if category == 'error' %}bg-red-50 text-red-800 border-l-4 border-red-600{% else %}bg-green-50 text-green-800 border-l-4 border-green-600{% endif %}"
          >
            <div class="flex items-center gap-3">
              <i
                class="fas {% if category == 'error' %}fa-exclamation-circle{% else %}fa-check-circle{% endif %} text-xl"
              ></i>
              <p class="font-medium">{{ message }}</p>
            </div>
          </div>
          {% endfor %}
        </div>
        {% endif %} {% endwith %} {% block content %}{% endblock %}
      </main>
    </div>

    <script>
      // Sidebar toggle for mobile
      const sidebarToggle = document.getElementById("sidebar-toggle");
      const sidebar = document.getElementById("sidebar");
      const mobileOverlay = document.getElementById("mobile-overlay");

      function toggleSidebar() {
        sidebar.classList.toggle("hidden-mobile");
        mobileOverlay.classList.toggle("active");
        document.body.style.overflow = sidebar.classList.contains(
          "hidden-mobile",
        )
          ? "auto"
          : "hidden";
      }

      sidebarToggle.addEventListener("click", (e) => {
        e.stopPropagation();
        toggleSidebar();
      });

      // Close sidebar when clicking overlay
      mobileOverlay.addEventListener("click", () => {
        toggleSidebar();
      });

      // Close sidebar when clicking outside on mobile
      document.addEventListener("click", (e) => {
        if (window.innerWidth < 1024) {
          if (
            !sidebar.contains(e.target) &&
            !sidebarToggle.contains(e.target) &&
            !sidebar.classList.contains("hidden-mobile")
          ) {
            toggleSidebar();
          }
        }
      });

      // Handle window resize
      window.addEventListener("resize", () => {
        if (window.innerWidth >= 1024) {
          sidebar.classList.remove("hidden-mobile");
          mobileOverlay.classList.remove("active");
          document.body.style.overflow = "auto";
        }
      });
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
