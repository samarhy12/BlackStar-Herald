{% extends "base.html" %} {% block meta %}
<meta name="description" content="" id="meta-description" />
<meta name="keywords" content="" id="meta-keywords" />
<meta name="author" content="BlackStar Herald" />
<link rel="canonical" href="" id="canonical-link" />
{% endblock %} {% block og_meta %}
<meta property="og:type" content="article" />
<meta property="og:url" content="{{ request.url }}" id="og-url" />
<meta property="og:site_name" content="BlackStar Herald" />
<meta property="og:title" content="" id="og-title" />
<meta property="og:description" content="" id="og-description" />
<meta property="og:image" content="" id="og-image" />
<meta property="article:published_time" content="" id="article-published" />
<meta property="article:modified_time" content="" id="article-modified" />
<meta property="article:author" content="" id="article-author" />
<meta property="article:section" content="" id="article-section" />
<meta property="article:tag" content="" id="article-tags" />
{% endblock %} {% block twitter_meta %}
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content="{{ request.url }}" id="twitter-url" />
<meta name="twitter:title" content="" id="twitter-title" />
<meta name="twitter:description" content="" id="twitter-description" />
<meta name="twitter:image" content="" id="twitter-image" />
<meta name="twitter:creator" content="@easternstar" />
{% endblock %} {% block title %}{% endblock %} {% block extra_css %}
<style>
  /* Article Content Styling */
  #article-content {
    color: #374151;
    line-height: 1.8;
  }

  #article-content h2 {
    font-family: "Playfair Display", serif;
    font-size: 2rem;
    font-weight: 700;
    color: #111827;
    margin-top: 2.5rem;
    margin-bottom: 1.5rem;
    line-height: 1.3;
  }

  #article-content h3 {
    font-family: "Playfair Display", serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
    margin-top: 2rem;
    margin-bottom: 1rem;
    line-height: 1.4;
  }

  #article-content p {
    font-size: 1.125rem;
    margin-bottom: 1.5rem;
    color: #374151;
  }

  #article-content strong {
    font-weight: 700;
    color: #111827;
  }

  #article-content a {
    color: #2563eb;
    text-decoration: underline;
  }

  #article-content a:hover {
    color: #1d4ed8;
  }

  #article-content ul,
  #article-content ol {
    margin-left: 1.5rem;
    margin-bottom: 1.5rem;
  }

  #article-content li {
    margin-bottom: 0.5rem;
  }

  #article-content blockquote {
    border-left: 4px solid #2563eb;
    padding-left: 1.5rem;
    margin: 2rem 0;
    font-style: italic;
    color: #4b5563;
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 0.5rem;
  }

  #article-content img {
    border-radius: 0.75rem;
    margin: 2rem 0;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  }

  /* First letter styling */
  #article-content p:first-of-type::first-letter {
    font-family: "Playfair Display", serif;
    font-size: 3.5rem;
    font-weight: 700;
    float: left;
    line-height: 3rem;
    margin-right: 0.5rem;
    margin-top: 0.25rem;
    color: #2563eb;
  }

  /* Social share buttons */
  .social-share-btn {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .social-share-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
  }

  /* Comment cards */
  .comment-card {
    background: white;
    border-radius: 1rem;
    padding: 1.5rem;
    border: 1px solid #e5e7eb;
    transition: all 0.3s ease;
  }

  .comment-card:hover {
    border-color: #3b82f6;
    box-shadow: 0 8px 20px rgba(59, 130, 246, 0.1);
  }
</style>
{% endblock %} {% block content %}
<!-- Article Content -->
<article class="bg-gray-50">
  <!-- Article Header -->
  <div class="bg-white border-b border-gray-200">
    <div class="container mx-auto px-4 pt-6 pb-8">
      <div class="max-w-4xl mx-auto">
        <!-- Breadcrumb -->
        <nav class="mb-6" id="breadcrumb">
          <ol class="flex items-center space-x-2 text-sm text-gray-500">
            <li><a href="/" class="hover:text-blue-600 transition">Home</a></li>
            <li><i class="fas fa-chevron-right text-xs"></i></li>
            <li id="breadcrumb-category"></li>
            <li><i class="fas fa-chevron-right text-xs"></i></li>
            <li
              class="text-gray-700 truncate max-w-xs"
              id="breadcrumb-title"
            ></li>
          </ol>
        </nav>

        <!-- Category & Breaking Badge -->
        <div
          id="article-badges"
          class="flex items-center flex-wrap gap-2 mb-6"
        ></div>

        <!-- Title -->
        <h1
          id="article-title"
          class="font-headline text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-6 leading-tight"
        ></h1>

        <!-- Excerpt -->
        <p
          id="article-excerpt"
          class="text-xl md:text-2xl text-gray-600 mb-8 leading-relaxed font-light"
        ></p>

        <!-- Meta Info -->
        <div class="flex flex-wrap items-center gap-4 gap-y-3">
          <div class="flex items-center" id="article-author">
            <!-- Author info loaded here -->
          </div>
          <span class="text-gray-300 hidden md:inline">•</span>
          <div class="flex flex-wrap items-center gap-3 text-sm text-gray-600">
            <span id="article-date" class="flex items-center"
              ><i class="far fa-calendar mr-1.5 text-gray-400"></i
            ></span>
            <span class="text-gray-300">•</span>
            <span id="article-read-time" class="flex items-center"
              ><i class="far fa-clock mr-1.5 text-gray-400"></i
            ></span>
            <span class="text-gray-300">•</span>
            <span id="article-views" class="flex items-center"
              ><i class="far fa-eye mr-1.5 text-gray-400"></i
            ></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Featured Image -->
  <div class="bg-white">
    <div class="container mx-auto px-4 py-8">
      <div class="max-w-5xl mx-auto">
        <div class="relative rounded-xl overflow-hidden shadow-2xl">
          <img id="article-image" src="" alt="" class="w-full h-auto" />
        </div>
      </div>
    </div>
  </div>

  <!-- Article Body -->
  <div class="bg-white py-12">
    <div class="container mx-auto px-4">
      <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
          <!-- Social Share Sidebar (Desktop) -->
          <div class="hidden lg:block lg:col-span-1">
            <div class="sticky top-24">
              <div id="social-share-sidebar" class="flex flex-col space-y-4">
                <!-- Social buttons loaded here -->
              </div>
            </div>
          </div>

          <!-- Main Content -->
          <div class="lg:col-span-7">
            <!-- Content -->
            <div
              id="article-content"
              class="prose prose-lg lg:prose-xl max-w-none mb-12"
            >
              <!-- Article content loaded here -->
            </div>

            <!-- Tags -->
            <div
              id="article-tags-section"
              class="mb-10 pb-10 border-b border-gray-200"
            >
              <h3
                class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4"
              >
                Related Topics
              </h3>
              <div id="article-tags" class="flex flex-wrap gap-2"></div>
            </div>

            <!-- Social Share (Mobile) -->
            <div class="lg:hidden mb-10 pb-10 border-b border-gray-200">
              <h3 class="text-lg font-bold text-gray-900 mb-5">
                Share this article
              </h3>
              <div id="social-share-mobile" class="flex flex-wrap gap-3">
                <!-- Social buttons loaded here -->
              </div>
            </div>

            <!-- Author Bio Card -->
            <div
              id="author-bio-card"
              class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-8 mb-12 border border-gray-200"
            >
              <div class="flex items-start gap-6">
                <img
                  id="author-bio-avatar"
                  src=""
                  alt=""
                  class="w-20 h-20 rounded-full ring-4 ring-white shadow-lg"
                />
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    <h4
                      id="author-bio-name"
                      class="text-xl font-bold text-gray-900"
                    ></h4>
                    <span
                      class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-medium"
                      >Author</span
                    >
                  </div>
                  <p
                    id="author-bio-description"
                    class="text-gray-600 leading-relaxed"
                  ></p>
                </div>
              </div>
            </div>

            <!-- Related Articles -->
            <div class="mb-12">
              <div class="flex items-center justify-between mb-6">
                <h3
                  class="font-headline text-2xl md:text-3xl font-bold text-gray-900"
                >
                  You May Also Like
                </h3>
                <div
                  class="h-1 flex-1 bg-gradient-to-r from-blue-600 to-transparent ml-6 rounded-full"
                ></div>
              </div>
              <div
                id="related-articles"
                class="grid grid-cols-1 sm:grid-cols-2 gap-6"
              >
                <!-- Related articles loaded here -->
              </div>
            </div>

            <!-- Comments Section -->
            <div id="comments-section" class="mb-12">
              <h3
                class="font-headline text-2xl md:text-3xl font-bold text-gray-900 mb-8 flex items-center"
              >
                <i class="far fa-comments text-blue-600 mr-3"></i>
                <span id="comments-count">Comments</span>
              </h3>

              <!-- Comment Form -->
              <div
                class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 mb-8 border border-blue-100"
              >
                <h4
                  class="text-lg font-bold text-gray-900 mb-6 flex items-center"
                >
                  <i class="fas fa-pen text-blue-600 mr-2"></i>
                  Join the Conversation
                </h4>
                <form id="comment-form" class="space-y-4">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input
                      type="text"
                      id="comment-name"
                      placeholder="Your Name"
                      required
                      class="px-5 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition bg-white"
                    />
                    <input
                      type="email"
                      id="comment-email"
                      placeholder="Your Email"
                      required
                      class="px-5 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition bg-white"
                    />
                  </div>
                  <textarea
                    id="comment-content"
                    rows="4"
                    placeholder="Share your thoughts..."
                    required
                    class="w-full px-5 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition bg-white resize-none"
                  ></textarea>
                  <button
                    type="submit"
                    class="bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-3 rounded-xl font-medium transition transform hover:scale-105 shadow-lg"
                  >
                    <i class="fas fa-paper-plane mr-2"></i>Post Comment
                  </button>
                </form>
                <div id="comment-message" class="mt-4 text-sm"></div>
              </div>

              <!-- Comments List -->
              <div id="comments-list" class="space-y-6">
                <!-- Comments loaded here -->
              </div>
            </div>
          </div>

          <!-- Sidebar -->
          <aside class="lg:col-span-4">
            <!-- Ad Space - Top -->
            <div class="mb-8 sticky top-24">
              <div class="ad-container rounded-xl" style="min-height: 280px">
                <div class="text-center text-gray-400 p-8">
                  <i class="fas fa-ad text-5xl mb-3"></i>
                  <p class="text-sm font-medium">Advertisement</p>
                  <p class="text-xs mt-1">(300 x 250)</p>
                </div>
              </div>
            </div>

            <!-- Trending Articles -->
            <div
              class="bg-white rounded-2xl shadow-lg p-6 mb-8 border border-gray-100"
            >
              <h3
                class="font-headline text-xl font-bold text-gray-900 mb-6 flex items-center"
              >
                <i class="fas fa-fire text-orange-500 mr-3 text-2xl"></i>
                <span>Trending Now</span>
              </h3>
              <div id="trending-articles" class="space-y-5">
                <!-- Trending articles loaded here -->
              </div>
            </div>

            <!-- Ad Space - Bottom -->
            <div class="mb-8">
              <div class="ad-container rounded-xl" style="min-height: 600px">
                <div class="text-center text-gray-400 p-8">
                  <i class="fas fa-ad text-5xl mb-3"></i>
                  <p class="text-sm font-medium">Advertisement</p>
                  <p class="text-xs mt-1">(300 x 600)</p>
                </div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </div>
  </div>
</article>

<!-- Schema.org structured data -->
<script type="application/ld+json" id="article-schema"></script>
{% endblock %} {% block extra_js %}
<script>
  const slug = window.location.pathname.split("/").pop();
  let articleData = null;

  // Fetch article
  async function fetchArticle() {
    try {
      showLoading();
      const response = await fetch(`/api/article/${slug}`);

      if (!response.ok) {
        window.location.href = "/";
        return;
      }

      articleData = await response.json();
      displayArticle(articleData);
      updateSEO(articleData);
      setupSocialSharing(articleData);
      fetchTrendingArticles();
      hideLoading();
    } catch (error) {
      console.error("Error fetching article:", error);
      window.location.href = "/";
    }
  }

  // Display article
  function displayArticle(article) {
    // Update title
    document.title = `${article.title} - BlackStar Herald`;
    document.getElementById("article-title").textContent = article.title;
    document.getElementById("breadcrumb-title").textContent =
      article.title.substring(0, 40) + (article.title.length > 40 ? "..." : "");

    // Update breadcrumb
    document.getElementById("breadcrumb-category").innerHTML = `
            <a href="/category/${article.category.slug}" class="hover:text-blue-600 transition">${article.category.name}</a>
        `;

    // Badges
    let badges = `<span class="${article.category.color} text-white px-4 py-1.5 rounded-lg text-sm font-bold shadow-sm">${article.category.name}</span>`;
    if (article.breaking) {
      badges =
        `<span class="bg-red-600 text-white px-4 py-1.5 rounded-lg text-sm font-bold shadow-sm animate-pulse"><i class="fas fa-bolt mr-1"></i> BREAKING</span> ` +
        badges;
    }
    document.getElementById("article-badges").innerHTML = badges;

    // Excerpt
    document.getElementById("article-excerpt").textContent = article.excerpt;

    // Author
    document.getElementById("article-author").innerHTML = `
            <img src="${article.author.avatar_url}" alt="${article.author.full_name}" class="w-12 h-12 rounded-full ring-2 ring-blue-100 mr-3">
            <div>
                <p class="font-bold text-gray-900">${article.author.full_name}</p>
                <p class="text-sm text-gray-500">${article.author.bio || "Staff Writer"}</p>
            </div>
        `;

    // Author Bio Card
    document.getElementById("author-bio-avatar").src =
      article.author.avatar_url;
    document.getElementById("author-bio-name").textContent =
      article.author.full_name;
    document.getElementById("author-bio-description").textContent =
      article.author.bio || "Staff Writer at BlackStar Herald News";

    // Meta
    document.getElementById("article-date").innerHTML =
      `<i class="far fa-calendar mr-1.5 text-gray-400"></i> ${article.date}`;
    document.getElementById("article-read-time").innerHTML =
      `<i class="far fa-clock mr-1.5 text-gray-400"></i> ${article.read_time}`;
    document.getElementById("article-views").innerHTML =
      `<i class="far fa-eye mr-1.5 text-gray-400"></i> ${article.views.toLocaleString()} views`;

    // Image
    const img = document.getElementById("article-image");
    img.src = article.image_url;
    img.alt = article.title;

    // Content
    document.getElementById("article-content").innerHTML = article.content;

    // Tags
    if (article.tags && article.tags.length > 0) {
      document.getElementById("article-tags").innerHTML = article.tags
        .map(
          (tag) => `
                <a href="/?tag=${tag.slug}" class="bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 text-blue-700 px-4 py-2 rounded-full text-sm font-medium transition border border-blue-200 hover:border-blue-300">
                    #${tag.name}
                </a>
            `,
        )
        .join("");
    } else {
      document.getElementById("article-tags-section").classList.add("hidden");
    }

    // Comments count
    const commentsCount = article.comments ? article.comments.length : 0;
    document.getElementById("comments-count").textContent =
      `${commentsCount} Comment${commentsCount !== 1 ? "s" : ""}`;

    // Comments
    displayComments(article.comments);

    // Related articles
    displayRelatedArticles(article.related);
  }

  // Update SEO meta tags
  function updateSEO(article) {
    // Meta tags
    document
      .getElementById("meta-description")
      .setAttribute("content", article.meta_description || article.excerpt);
    document
      .getElementById("meta-keywords")
      .setAttribute("content", article.meta_keywords || "");
    document
      .getElementById("canonical-link")
      .setAttribute("href", article.canonical_url);

    // Open Graph
    document
      .getElementById("og-url")
      .setAttribute("content", article.canonical_url);
    document.getElementById("og-title").setAttribute("content", article.title);
    document
      .getElementById("og-description")
      .setAttribute("content", article.meta_description || article.excerpt);
    document
      .getElementById("og-image")
      .setAttribute("content", article.image_url);
    document
      .getElementById("article-published")
      .setAttribute("content", article.date_iso);
    document
      .getElementById("article-modified")
      .setAttribute("content", article.updated_at);
    document
      .getElementById("article-author")
      .setAttribute("content", article.author.full_name);
    document
      .getElementById("article-section")
      .setAttribute("content", article.category.name);
    if (article.tags && article.tags.length > 0) {
      document
        .getElementById("article-tags")
        .setAttribute("content", article.tags.map((t) => t.name).join(", "));
    }

    // Twitter
    document
      .getElementById("twitter-url")
      .setAttribute("content", article.canonical_url);
    document
      .getElementById("twitter-title")
      .setAttribute("content", article.title);
    document
      .getElementById("twitter-description")
      .setAttribute("content", article.meta_description || article.excerpt);
    document
      .getElementById("twitter-image")
      .setAttribute("content", article.image_url);

    // Structured data (Schema.org)
    const schema = {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      headline: article.title,
      image: article.image_url,
      datePublished: article.date_iso,
      dateModified: article.updated_at,
      author: {
        "@type": "Person",
        name: article.author.full_name,
      },
      publisher: {
        "@type": "Organization",
        name: "BlackStar Herald",
        logo: {
          "@type": "ImageObject",
          url: window.location.origin + "/static/logo.png",
        },
      },
      description: article.meta_description || article.excerpt,
      mainEntityOfPage: {
        "@type": "WebPage",
        "@id": article.canonical_url,
      },
    };
    document.getElementById("article-schema").textContent =
      JSON.stringify(schema);
  }

  // Setup social sharing
  function setupSocialSharing(article) {
    const url = encodeURIComponent(article.canonical_url);
    const title = encodeURIComponent(article.title);
    const description = encodeURIComponent(article.excerpt);

    const shareButtons = `
            <a href="https://www.facebook.com/sharer/sharer.php?u=${url}" target="_blank" rel="noopener noreferrer"
               class="social-share-btn bg-blue-600 hover:bg-blue-700 text-white" title="Share on Facebook">
                <i class="fab fa-facebook-f text-lg"></i>
            </a>
            <a href="https://twitter.com/intent/tweet?url=${url}&text=${title}" target="_blank" rel="noopener noreferrer"
               class="social-share-btn bg-sky-500 hover:bg-sky-600 text-white" title="Share on Twitter">
                <i class="fab fa-twitter text-lg"></i>
            </a>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}&summary=${description}" target="_blank" rel="noopener noreferrer"
               class="social-share-btn bg-blue-700 hover:bg-blue-800 text-white" title="Share on LinkedIn">
                <i class="fab fa-linkedin-in text-lg"></i>
            </a>
            <a href="https://wa.me/?text=${title}%20${url}" target="_blank" rel="noopener noreferrer"
               class="social-share-btn bg-green-500 hover:bg-green-600 text-white" title="Share on WhatsApp">
                <i class="fab fa-whatsapp text-lg"></i>
            </a>
            <button onclick="copyToClipboard('${article.canonical_url}')"
               class="social-share-btn bg-gray-600 hover:bg-gray-700 text-white" title="Copy link">
                <i class="fas fa-link text-lg"></i>
            </button>
        `;

    document.getElementById("social-share-sidebar").innerHTML = shareButtons;
    document.getElementById("social-share-mobile").innerHTML = shareButtons;
  }

  // Copy to clipboard
  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      alert("Link copied to clipboard!");
    });
  }

  // Display comments
  function displayComments(comments) {
    const container = document.getElementById("comments-list");

    if (!comments || comments.length === 0) {
      container.innerHTML = `
                <div class="text-center py-12 bg-white rounded-2xl border-2 border-dashed border-gray-200">
                    <i class="far fa-comments text-gray-300 text-6xl mb-4"></i>
                    <p class="text-gray-500 text-lg font-medium">No comments yet</p>
                    <p class="text-gray-400 text-sm mt-2">Be the first to share your thoughts!</p>
                </div>
            `;
      return;
    }

    const html = comments
      .map(
        (comment) => `
            <div class="comment-card">
                <div class="flex items-start gap-4">
                    <img src="https://ui-avatars.com/api/?name=${encodeURIComponent(comment.author_name)}&background=random&size=48" 
                         alt="${comment.author_name}" class="w-12 h-12 rounded-full ring-2 ring-gray-100 flex-shrink-0">
                    <div class="flex-1">
                        <div class="flex items-center justify-between mb-3">
                            <div>
                                <h5 class="font-bold text-gray-900">${comment.author_name}</h5>
                                <span class="text-xs text-gray-500"><i class="far fa-clock mr-1"></i>${comment.created_at}</span>
                            </div>
                        </div>
                        <p class="text-gray-700 leading-relaxed">${comment.content}</p>
                    </div>
                </div>
            </div>
        `,
      )
      .join("");

    container.innerHTML = html;
  }

  // Display related articles
  function displayRelatedArticles(articles) {
    const container = document.getElementById("related-articles");

    if (!articles || articles.length === 0) {
      container.innerHTML = `
                <div class="col-span-full text-center py-12 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200">
                    <i class="fas fa-newspaper text-gray-300 text-5xl mb-3"></i>
                    <p class="text-gray-500">No related articles found</p>
                </div>
            `;
      return;
    }

    const html = articles
      .map(
        (article) => `
            <article class="bg-white rounded-2xl shadow-lg overflow-hidden hover-lift border border-gray-100 group">
                <a href="/article/${article.slug}">
                    <div class="relative overflow-hidden">
                        <img src="${article.image_url}" alt="${article.title}" 
                             class="w-full h-48 object-cover group-hover:scale-110 transition duration-500">
                        <div class="absolute top-3 left-3">
                            <span class="${article.category.color} text-white px-3 py-1 rounded-lg text-xs font-bold shadow-lg">
                                ${article.category.name}
                            </span>
                        </div>
                    </div>
                </a>
                <div class="p-5">
                    <h4 class="font-headline text-lg font-bold text-gray-900 mb-3 line-clamp-2 group-hover:text-blue-600 transition leading-tight">
                        <a href="/article/${article.slug}">${article.title}</a>
                    </h4>
                    <p class="text-gray-600 text-sm line-clamp-2 mb-4">${article.excerpt}</p>
                    <div class="flex items-center text-xs text-gray-500">
                        <span class="flex items-center">
                            <i class="far fa-clock mr-1"></i> ${article.read_time}
                        </span>
                    </div>
                </div>
            </article>
        `,
      )
      .join("");

    container.innerHTML = html;
  }

  // Fetch trending articles
  async function fetchTrendingArticles() {
    try {
      const response = await fetch("/api/articles/trending?limit=5");
      const articles = await response.json();
      displayTrendingArticles(articles);
    } catch (error) {
      console.error("Error fetching trending articles:", error);
    }
  }

  // Display trending articles
  function displayTrendingArticles(articles) {
    const container = document.getElementById("trending-articles");

    if (articles.length === 0) {
      container.innerHTML =
        '<p class="text-center text-gray-500 text-sm">No trending articles</p>';
      return;
    }

    const html = articles
      .map(
        (article, index) => `
            <div class="flex gap-4 pb-5 border-b border-gray-100 last:border-0 group">
                <div class="flex-shrink-0">
                    <span class="text-3xl font-bold bg-gradient-to-br from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                        ${(index + 1).toString().padStart(2, "0")}
                    </span>
                </div>
                <div class="flex-1 min-w-0">
                    <h4 class="font-semibold text-sm text-gray-900 group-hover:text-blue-600 transition line-clamp-3 mb-2 leading-snug">
                        <a href="/article/${article.slug}">${article.title}</a>
                    </h4>
                    <div class="flex items-center text-xs text-gray-500">
                        <i class="far fa-eye mr-1"></i>
                        <span class="font-medium">${article.views.toLocaleString()}</span>
                    </div>
                </div>
            </div>
        `,
      )
      .join("");

    container.innerHTML = html;
  }

  // Comment form submission
  document
    .getElementById("comment-form")
    .addEventListener("submit", async (e) => {
      e.preventDefault();

      const name = document.getElementById("comment-name").value;
      const email = document.getElementById("comment-email").value;
      const content = document.getElementById("comment-content").value;
      const messageEl = document.getElementById("comment-message");

      try {
        const response = await fetch("/api/comment", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            article_id: articleData.id,
            author_name: name,
            author_email: email,
            content: content,
          }),
        });

        const data = await response.json();
        messageEl.innerHTML = `<span class="text-green-600">${data.message}</span>`;
        document.getElementById("comment-form").reset();
      } catch (error) {
        messageEl.innerHTML =
          '<span class="text-red-600">Failed to post comment. Please try again.</span>';
      }
    });

  // Initialize
  document.addEventListener("DOMContentLoaded", () => {
    fetchArticle();
  });
</script>
{% endblock %}
